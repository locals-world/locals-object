<!--
@license
Copyright (c) 2016 A-labs. All rights reserved.
/////////////////
LOCALS
/////////////////
-->

<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../neon-animation/neon-animation.html">
<link rel="import" href="../iron-form/iron-form.html">
<link rel="import" href="../iron-form/iron-form.html">
<link rel="import" href="../locals-input/locals-input.html">
<link rel="import" href="../locals-style/locals-style.html">

<link rel="import" href="../iron-input/iron-input.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../locals-button/locals-button.html">


<!--
An element providing a solution to no problem in particular.

Example:

    <locals-object></locals-object>
Example:
<locals-object>
<h2>Hello locals-object</h2>
</locals-object>
@demo demo/index.html
@hero hero.svg
-->
<dom-module id="locals-dataobject">
<template>
  <style>
      :host {
        display: block;
        box-sizing: border-box;
      }
      h1 {
        @apply(--locals-font-h1);
      }
      h2 {
        @apply(--locals-font-h2);
      }
      .firstvalue {
        width: 100%;
        @apply(--layout-horizontal);
        @apply(--layout-center-center);
      }

      .firstvalue h1 {
        font-size: 22px;
      }

    </style>

  <template is="dom-if" if="{{!editmode}}">
    <div class="firstvalue" on-tap="_toEdit">
    <h1>Benny</h1>
    </div>
  </template>

  <template is="dom-if" if="{{editmode}}">
<!-- 
    <form is="iron-form" id="avatarform" on-iron-form-submit="_submit">
      <template is="dom-repeat" items="{{_getFields()}}">
        <locals-input id="{{item.name}}" name="{{item.name}}" label="{{item.label}}" required></locals-input>
      </template>
      <locals-button iconcolor="darkgrey" on-tap="_save(event)" icon="v"></locals-button>
      <locals-button iconcolor="darkgrey" on-tap="_discard" icon="decline"></locals-button>

    </form>

 -->

<form is="iron-form" method="get" on-iron-form-submit="_submitform" action="/" id="basic">
<!-- <input is="iron-input" name="zaza" label="zozo"/> -->
   <template is="dom-repeat" items="{{_getFields(state)}}">
    <!-- <input is="iron-input" name="{{item.name}}" label="{{item.label}}"> -->
    <!-- <paper-input name="{{item.name}}" label="{{item.label}}"></paper-input> -->

    <locals-input name="{{item.name}}" label="{{item.label}}" inputvalue="{{_getValue(item.name,state)}}"></locals-input>

  </template>
  
<!-- <locals-input name="{{item.name}}" label="{{item.label}}"></locals-input> -->
<!-- 
  <input type="checkbox" name="food" value="donuts" checked> I like donuts<br>
  <input type="checkbox" name="food" value="pizza" required> I like pizza<br>
  -->
  <locals-button raised on-tap="_submit">Submit</locals-button>
  <locals-button raised onclick="_reset(event)">Reset</locals-button>
  <div class="output"></div>
</form>




  </template>
</template>

<script>
    Polymer({
      is: 'locals-dataobject',

      properties: {
        config: {
          type: Object
        },
        editmode: {
          type: Boolean,
          value: false
        },
        state: {
          type: Object,
          notify: true
        },
      },

      _submit: function(event) {
        Polymer.dom(event).localTarget.parentElement.submit();
      },

      _submitform: function(e) {
//        console.log(e.detail);
        this.state = e.detail;
        this._toView();
        this.fire('state-changed');
      },

      _eq: function(a, b) {
        return a == b;
      },


      ready: function() {
        // `ready` is called after all elements have been configured, but
        // propagates bottom-up. This element's children are ready, but parents
        // are not.
        //
        // This is the point where you should make modifications to the DOM (when
        // necessary), or kick off any processes the element wants to perform.
      },

      attached: function() {
        // `attached` fires once the element and its parents have been inserted
        // into a document.
        //
        // This is a good place to perform any work related to your element's
        // visual state or active behavior (measuring sizes, beginning animations,
        // loading resources, etc).


        // var self = this;
        // setInterval(function(){
        //   self.selected++;
        //   console.log('length=',Object.keys(self.options).length);
        //   if (self.selected >= Object.keys(self.options).length){
        //     self.selected = 0;
        //   }
        // },1000)
      },

      detached: function() {
        // The analog to `attached`, `detached` fires when the element has been
        // removed from a document.
        //
        // Use this to clean up anything you did in `attached`.
      },

      _toEdit: function() {
        this.editmode = true;
      },

      _toView: function() {
        this.editmode = false;
      },

      _getFields: function() {
        return this.config.fields;
      },

      _getValue: function(inputfieldname) {
        return this.state[inputfieldname];
      },

      _discard: function() {
        this.editmode = false;
      },

      _inanimation: function() {
        // console.log('Dit issem', this.inanimation);
      },

      _outanimation: function() {
        // console.log('Dit issem', this.outanimation);
      },

    });
  </script>
</dom-module>